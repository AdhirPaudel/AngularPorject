"use strict";(self.webpackChunkUnstopProject=self.webpackChunkUnstopProject||[]).push([[291],{291:(C,h,r)=>{r.r(h),r.d(h,{UserRoleChartComponent:()=>d});var l=r(5861),t=r(1571),u=r(4685);const c=["roleChart"];let d=(()=>{class o{constructor(e,s){this.zone=e,this.userService=s,this.users=[],this.users$=this.userService.getUsers()}ngOnChanges(e){e.users&&this.Chart&&this.zone.runOutsideAngular(()=>{setTimeout(()=>this.renderChart(this.Chart),0)})}ngAfterViewInit(){var e=this;return(0,l.Z)(function*(){e.zone.runOutsideAngular(()=>{setTimeout((0,l.Z)(function*(){const{default:s}=yield r.e(320).then(r.bind(r,6320));e.Chart=s,e.renderChart(s)}),0)})})()}renderChart(e){if(console.log(this.users),!this.users||0===this.users.length)return;const s=this.chartRef.nativeElement?.getContext("2d");if(!s)return console.warn("Canvas not ready, re-rendering"),void setTimeout(()=>this.renderChart(e),50);this.chart&&this.chart.destroy();const n={Admin:this.users.filter(i=>"Admin"===i.role).length,Editor:this.users.filter(i=>"Editor"===i.role).length,Viewer:this.users.filter(i=>"Viewer"===i.role).length};console.log(n),this.chart=new e(s,{type:"pie",data:{labels:["Admin","Editor","Viewer"],datasets:[{data:[n.Admin,n.Editor,n.Viewer],backgroundColor:["#42A5F5","#EC407A","#FFB74D"]}]},options:{responsive:!0,maintainAspectRatio:!1}})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(t.R0b),t.Y36(u.R))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-user-role-chart"]],viewQuery:function(e,s){if(1&e&&t.Gf(c,5),2&e){let n;t.iGM(n=t.CRH())&&(s.chartRef=n.first)}},inputs:{users:"users"},standalone:!0,features:[t.TTD,t.jDz],decls:2,vars:0,consts:[["width","300","height","300"],["roleChart",""]],template:function(e,s){1&e&&t._UZ(0,"canvas",0,1)}}),o})()}}]);